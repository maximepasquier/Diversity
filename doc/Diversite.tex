\chapter{Diversité} \label{ch:DIV}

\section{Mesures et méthodologie}

\begin{table}[H]
	\centering
	\captionsetup{justification=centering}
	\caption[1]{2\label{tab:grid}}
	\begin{tabular}{@{\extracolsep{\fill} } c|| c| c| c|}
		4    & 1     & 10    & 50    \\
		\midrule
		\midrule
		1    & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.75 & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.5  & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.25 & 10/10 & 10/10 & 10/10 \\
		\bottomrule
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\captionsetup{justification=centering}
	\caption[1]{2\label{tab:grid}}
	\begin{tabular}{@{\extracolsep{\fill} } c|| c| c| c|}
		8    & 1     & 10    & 50    \\
		\midrule
		\midrule
		1    & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.75 & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.5  & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.25 & 10/10 & 10/10 & 10/10 \\
		\bottomrule
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\captionsetup{justification=centering}
	\caption[1]{2\label{tab:grid}}
	\begin{tabular}{@{\extracolsep{\fill} } c|| c| c| c|}
		16    & 1     & 10    & 50    \\
		\midrule
		\midrule
		1    & 10/10 & 10/10 & 10/10 \\
		\midrule
		0.75 & 6/10 & 10/10 & 9/10 \\
		\midrule
		0.5  & 9/10 & 7/10 & 10/10 \\
		\midrule
		0.25 & 3/10 & 7/10 & 6/10 \\
		\bottomrule
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\captionsetup{justification=centering}
	\caption[1]{2\label{tab:grid}}
	\begin{tabular}{@{\extracolsep{\fill} } c|| c| c| c|}
		32    & 1     & 10    & 50    \\
		\midrule
		\midrule
		1    & 0/10 & 5/10 & 8/10 \\
		\midrule
		0.75 & 0/10 & 4/10 & 8/10 \\
		\midrule
		0.5  & 0/10 & 4/10 & 6/10 \\
		\midrule
		0.25 & 0/10 & 1/10 & 2/10 \\
		\bottomrule
	\end{tabular}
\end{table}

L'objectif du travail est de quantifier l'impacte de la diversité sur la propagation de pandémies. Cette section est dédié à la prises de mesures avec des niveaux de diversité différents et d'en constater les résultats. Afin de ne pas trop complexifier le modèle au delà des simulations SIR, nous ne modifions que le paramètre de diversité ainsi que la charge virale. D'autres paramètres du modèle pourraient être étudié mais ce chapitre ne les explore pas.\\

Toutes les musures de diversité ont été effectuées sur des systèmes aux paramètres semblables. La taille des systèmes est définie à $1264\times 1264$ avec une population de $10^5$ individus, il s'agit de systèmes en densité $\frac{1}{16}$. Un exemple de fichier de configuration est donné ci-dessous.

\begin{minted}
	[
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	bgcolor=LightGray,
	fontsize=\footnotesize,
	linenos
	]
	{c++}
	TAILLE_SYSTEME = 1264
	NOMBRE_INDIVIDUS = 100000
	ITERATIONS = 5000
	RERUN_LIMIT = 100
	FAIL_SEUIL = 30
	GENOME_INIT_I = 0
	GENOME_DIVERSITY_I = 8
	GENOME_INIT_AP = 0
	VITESSE_MUTATIONS_AP = 0
	CHARGE_VIRALE = 1
	PARAMETRE_FONCTION = 4
	CELLULE_AP = 0
	SURVIE_AP = 0
	NOMBRE_MOUVEMENT = 1
	PERFECT_MIX = true
	TEMPS_AVANT_IMMUNITE = 1
	IMMUNITE_MECANISME = true
	RESISTANCE_MECANISME = false
\end{minted}

L'exemple de fichier de configuration produit une simulation au mélange parfait avec une diversité de $8$. La configuration est similaire à celle d'une simulation SIR, la seule différence ici est l'ajout d'un paramètre de diversité non égal à $0$.\\

Toutes les simulations qui suivent se basent sur ce fichier de configuration mais avec quelques modifications.\\

Premièrement, le niveau de diversité varie d'une simulation à une autre. Les valeurs de diversité choisie sont : $4,8,16,32$. Pour rappel, une diversité de $x$ signifie que $x$ bits des génomes des individus seront complémentés et ceci alétoirement. Sans diversité les génomes des individus sont tous identiques.\\

Deuxièmement, le mode de mouvement ainsi que le nombre de mouvements varie. Seule la première simulation servant d'exemple utilise le mode de mouvement au mélange parfait, toutes les autres ont un nombre de mouvements défini. Les mouvements étudiés sont : $1,10,50$.\\

Finalement nous faisons varier le paramètre de charge virale (ici défini à 1). L'idée principale est ralentir la propagation de pandémies en diminuant la contagion des agents pathogènes. Les simulations sont effectuée sur $4$ niveaux de charge virale : $0.25,0.5,0.75,1$\\

Les résultats du chapitre se découpent en $5$ parties. La première sert d'exemple et permet d'expliquer les mécaniques derrière la diversité. Les $4$ autres parties explorent les $4$ niveaux de mouvements, les $4$ niveaux de diversité et les $4$ niveaux de charge virale.

\section{Résultats}

Chaque figure est structuré de la même manière. Il y a 3 subplots pour les 3 compartiements du modèle SIR. Les quatres courbes par compartiment représentent le nombre d'infectés de simulations aux niveaux de diversité différents.

\subsection{Mélange parfait}

Le document ne contient qu'une seule simulation à diversité non nulle et au mélange parfait. La raison pour laquelle cette voie n'est que peu explorée est parceque le mélange parfait est trop efficace pour la propagation de pandémies. Par conséquent les propagations sont beaucoup trop rapides comparé au ralentissement qu'offre la diversité.

\begin{figure}[h]
	\centering
	\captionsetup{justification=centering}
	\includegraphics[width=.7\textwidth]{Images/SIR_diversite_mix.pdf}
	\caption{Comparaison 50 mouvements}
\end{figure}

Les résultats des simulations au mélange parfait sont très similaire aux simulations SIR et ceci est dû au fait que l'impacte de la diversité est trop faible sur cette simulation. Pour pouvoir étudier l'impact de la diversité il est nécessaire de construire des systèmes plus progressifs dans la propagation des agents pathogènes.\\

Deux choses sont à noter à propos de cette figure. La première est que la propagation est beaucoup trop rapide comme nous pouvons le voir sur le compartiement $Susceptible$. Tous les individus sont déjà passés dans le compartiment $Infected$ très tôt dans la simulation. Par conséquent dans ces configurations la propagation de la pandémie est maximale car elle atteint rapidement $100\%$ de la population.\\

Le deuxième élément se produit dans une deuxième phase et décrit l'immunisation des individus. Comme nous l'avons déjà dit, tout les individus finissent contaminés très vite. A partir de là, les individus s'immunisent mais leur immunisation dépend de la compatibilité qu'ils ont avec leur agent pathogène. Le compartiment $Recovered$ montre la différence de vitesse des acquisitions d'immunisation parmi la population et il est assez clair qu'un plus grand niveau de diversité inplique une immunisation générale plus rapide. Par conséquent la diversité permet une meilleure immunisation de la population.

\newpage

\subsection{Mouvements variable}

Les simulations qui suivent pour étudier la diversité des individus ont toutes été effecutée avec des mouvements variable. Les mouvements choisi sont : $1,10,50$.

\begin{figure}[h]
	\centering
	\captionsetup{justification=centering}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_1_50.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_075_50.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_05_50.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_025_50.pdf}
	\caption{50 mouvements}
\end{figure}

La première série de graphiques est une ensemble de simulations à $50$ mouvements. Les comportements sont très semblables à la simulation de référence au mélange parfait. Très rapidement, tous les individus sortent du compartiement $Susceptible$ et donc la pandémie atteint une propagation de $100\%$. La seule action de la diversité est de permettre une immunisation plus rapide.\\

Les 4 figures utilisent chacune une valeur de charge virale différente. Les valeurs choisies sont : $1,0.75,0.5,0.25$. Le facteur de charge virale est directement lié avec la propagation de l'épidémie. Sur les figures nous constatons un ralentissement de la propagation lorsque la charge virale baisse. Ce comportement est normal car le facteur réduit les contactes entre les voisins.\\

Pour conclure, ces plots ne montrent que deux types de pandémies. Le premier type est une pandémie totale qui touche toute la population et le second type est une pandémie qui ne démarre pas. Les pandémies qui ne se sont pas propagées ont leur courbe coupée très tôt dans la simulation comme nous pouvons le voir dans les simulations aux charge virale de $0.5$ et $0.25$ pour les cas à diversité $32$.

\newpage

\begin{figure}[h]
	\centering
	\captionsetup{justification=centering}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_1_10.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_075_10.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_05_10.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_025_10.pdf}
	\caption{Comparaison 10 mouvements}
\end{figure}

Etant donné que les simulations aux $50$ mouvements sont trop rapides, nous baissons les mouvements des individus et les passons à $10$. L'objectif est de pouvoir observer des épidémies qui se propagent en partie sans que ce soit du tout ou rien.\\

Les résultats ne montrent rien de nouveau. La diversité impacte la vitesse d'immunisation mais la propagation de la pandémie n'en est pas affectée. Certes les individus restent plus longtemps dans le compartiement $Susceptible$ mais finissent tous par être contaminés donc nous avons encore à faire à des pandémies aux propagations de $100\%$.

\newpage

\begin{figure}[h]
	\centering
	\captionsetup{justification=centering}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_1_1.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_075_1.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_05_1.pdf}
	\includegraphics[width=.4\textwidth]{Images/SIR_diversite_025_1.pdf}
	\caption{Comparaison 1 mouvements}
\end{figure}

Finalement la dernière analyse de diversité effectue les mêmes mesures sur des systèmes à $1$ mouvement. Notez que l'échelle ici est passée à $5000$ sur les abscisses. Ces simulations ont un rypthme d'évolution beaucoup plus lent mais suivent les mêmes tendances. Pour toutes ces simulations les pandémies se propagent ou non, totalement ou pas du tout.

\subsection{Conclusion des résultats}

Les résultats permettent d'observer l'impacte de la diversité sur les systèmes. Apparemment il n'y a pas d'impacte sur la propagation de la pandémie mais uniquement sur la vitesse d'immunisation des individus. Nous cherchions à observer des pandémies qui évoluaient jusqu'à un certain point et dissparaissait ensuite mais ce comportement n'est pas présent dans les mesures.\\

L'absence de ces événements est dû au fonctionnement du modèle et à la notion de diversité. Le problème est que dans le modèle, la diversité n'a aucun impacte sur le propagation de pandémie. Pour rappel, lorsqu'un individu sain est en contact avec un agent pathogène, l'individu devient contaminé et contagieux directement et ceci peu importe la diversité du système. Le seul effet de la diverstié est le fait que cet individu peut s'immuniser plus ou moins rapidement en fonction de cette diversité. Mais le problème est que la propagation se présente sous forme de vague, comme une onde. L'illustration ci-dessous illustre le phénomène.

\begin{figure}[h]
	\centering
	\captionsetup{justification=centering}
	\includegraphics[width=.5\textwidth]{Images/vague_propagation.png}
	\caption{vague propagation}
\end{figure}

La figure montre la propagation d'une pandémie. En vert nous avons les individus sains, en bleu les individus immunisés et en rouge les individus contaminés. Les cercles représentent la propagation de la pandémie sous forme de vagues. Nous pourrion découper le processus en 3 zones distinctes et indépendantes. Le première est la zone centrale du cercle avec les individus immunisés. La seconde est la frontière entre les individus infectés et les sains donc la vague (cercle rouge) et finalement la troisième zone est le reste du système avec uniquement des individus sains.\\

D'après les résultats des simulations, la diversité n'impacte pas la propagation de la pandémie. En effet, la diversité permet l'immunisation plus rapide de la population donc l'apparition davantages de cercles bleus sur l'image. Le problème est que cette première zone est indépendante de la deuxième qui est la vague car cette dernière est beaucoup plus rapide que l'immunisation. Un individu fraichement contaminé propagera la pandémie bien avant qu'il ne s'immunise. Par conséquent, l'ampleur des immunisation n'impacte pas la propagation de la pandémie.\\

Donc la première zone n'affecte pas la vague mais qu'en est-il de la troisième zone ? En réalité la troisième zone est purement uniforme. Si une vague parvient à un moment donné à se propager dans la troisième zone alors elle le pourra jusqu'à contaminer tous les individus.\\

La rélexion mène donc à expliquer que une pandémie se propage soit complètement soit pas du tout.\\

En épidémiologie, le nombre de reproduction de base $R_0$ représente le nombre moyen de contaminations par un individu contaminé. Si ce taux est au dessous de $1$, cela signifie que la pandémie est mourante par contre si le taux est au dessus de $1$, la pandémie se propage.\\

Dans le modèle implémenté et d'après les mesures de diversité, une simulations ne peut pas avoir un $R_0$ qui varie. Cette valeur est fixe du début à la fin. Par conséquent, toutes les simulations au $R_0 < 1$ ne montrent aucune pandémie et au contraire toutes les simulations au $R_0 > 1$ finissent par contaminer tout le monde. Dans une situation réelle, des mesures sanitaires permettent de faire varier ce taux au cours de la propagation de la pendémie. Dans le modèle ce fonctionnement est non présent. Une autre chose n'est pas présente et donc impossible dans le modèle est l'effet d'immunité collective.\\

L'immunité collective est le fait le niveau d'immunité général est siffisemment élevé afin de faire passer le taux $R_0$ en dessous de $1$ et que la pandémie disparaisse. Ce phénomène peut s'obtenir par trois façons. La première est la vaccination, la seconde est l'immunité croisée et la troisième est une forme de résistance naturelle. Si nous reprenions la figure ci-dessus, l'immunité collective dans le modèle pourraient être obtenue d'une seule façon. Il faudrait pouroivr modifier l'état de la troisième zone (les parties du système non contaminés). Si au fil du temps nous pouvions vacciner des individus ou les immuniser en amont de la pandémie alors nous pourrions influencer le $R_0$ de la simulation mais le modèle n'inclut pas ces mécanismes. Par conséquent le $R_0$ reste constant dû à l'homogénéité de la troisième zone.


